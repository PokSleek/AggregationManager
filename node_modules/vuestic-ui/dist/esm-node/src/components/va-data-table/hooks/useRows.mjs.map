{"version":3,"file":"useRows.mjs","sources":["../../../../../../src/components/va-data-table/hooks/useRows.ts"],"sourcesContent":["import { Ref, ref, computed, ExtractPropTypes } from 'vue'\n\nimport { useItemsProp, useItemsTrackByProp } from './useCommonProps'\n\nimport { getValueByPath } from '../../../utils/value-by-key'\n\nimport type {\n  DataTableColumnInternal,\n  DataTableItem,\n  DataTableCell,\n  DataTableRow,\n  DataTableItemKey,\n} from '../types'\n\nexport const getItemKey = (source: DataTableItem, itemsTrackBy: string | ((item: DataTableItem) => any)): DataTableItemKey => (\n  typeof itemsTrackBy === 'function'\n    ? itemsTrackBy(source)\n    : getValueByPath(source, itemsTrackBy) || source\n)\n\nexport const useRowsProps = {\n  ...useItemsProp,\n  ...useItemsTrackByProp,\n}\n\nconst buildTableCell = (\n  rowIndex: number,\n  rowKey: string,\n  rowData: DataTableItem,\n  column: DataTableColumnInternal,\n): DataTableCell => {\n  const source = getValueByPath(rowData, column.key)\n\n  return {\n    rowIndex,\n    rowKey,\n    rowData,\n    column,\n    source,\n    value: source?.toString?.() || '',\n  }\n}\n\nconst buildTableRow = (\n  source: DataTableItem,\n  initialIndex: number,\n  itemsTrackBy: string | ((item: DataTableItem) => any),\n  columns: DataTableColumnInternal[],\n): DataTableRow => {\n  const itemKey = getItemKey(source, itemsTrackBy)\n\n  return {\n    initialIndex,\n    itemKey,\n    source,\n    cells: columns.map(column => buildTableCell(initialIndex, itemKey, source, column)),\n    rowData: source,\n  }\n}\n\nexport const useRows = (\n  columns: Ref<DataTableColumnInternal[]>,\n  props: ExtractPropTypes<typeof useRowsProps>,\n) => {\n  const expandableRows = ref<Record<number, boolean>>({})\n\n  const rowsComputed = computed(() => props.items\n    .map((rawItem, index) => ({\n      ...buildTableRow(rawItem, index, props.itemsTrackBy, columns.value),\n      toggleRowDetails: (show?: boolean) => {\n        if (typeof show === 'boolean') {\n          expandableRows.value[index] = show\n        } else {\n          expandableRows.value[index] = !expandableRows.value[index]\n        }\n      },\n      isExpandableRowVisible: !!expandableRows.value[index],\n    })))\n\n  return {\n    rowsComputed,\n  }\n}\n"],"names":[],"mappings":";;;AAcO,MAAM,aAAa,CAAC,QAAuB,iBAChD,OAAO,iBAAiB,aACpB,aAAa,MAAM,IACnB,eAAe,QAAQ,YAAY,KAAK;AAGvC,MAAM,eAAe;AAAA,EAC1B,GAAG;AAAA,EACH,GAAG;AACL;AAEA,MAAM,iBAAiB,CACrB,UACA,QACA,SACA,WACkB;;AAClB,QAAM,SAAS,eAAe,SAAS,OAAO,GAAG;AAE1C,SAAA;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,SAAO,sCAAQ,aAAR,oCAAwB;AAAA,EAAA;AAEnC;AAEA,MAAM,gBAAgB,CACpB,QACA,cACA,cACA,YACiB;AACX,QAAA,UAAU,WAAW,QAAQ,YAAY;AAExC,SAAA;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA,OAAO,QAAQ,IAAI,CAAA,WAAU,eAAe,cAAc,SAAS,QAAQ,MAAM,CAAC;AAAA,IAClF,SAAS;AAAA,EAAA;AAEb;AAEa,MAAA,UAAU,CACrB,SACA,UACG;AACG,QAAA,iBAAiB,IAA6B,CAAA,CAAE;AAEhD,QAAA,eAAe,SAAS,MAAM,MAAM,MACvC,IAAI,CAAC,SAAS,WAAW;AAAA,IACxB,GAAG,cAAc,SAAS,OAAO,MAAM,cAAc,QAAQ,KAAK;AAAA,IAClE,kBAAkB,CAAC,SAAmB;AAChC,UAAA,OAAO,SAAS,WAAW;AAC7B,uBAAe,MAAM,SAAS;AAAA,MAAA,OACzB;AACL,uBAAe,MAAM,SAAS,CAAC,eAAe,MAAM;AAAA,MACtD;AAAA,IACF;AAAA,IACA,wBAAwB,CAAC,CAAC,eAAe,MAAM;AAAA,IAC/C,CAAC;AAEE,SAAA;AAAA,IACL;AAAA,EAAA;AAEJ;;"}